!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.Jrouter=r():t.Jrouter=r()}(window,(function(){return function(t){var r={};function e(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,e),n.l=!0,n.exports}return e.m=t,e.c=r,e.d=function(t,r,o){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var n in t)e.d(o,n,function(r){return t[r]}.bind(null,n));return o},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=0)}([function(t,r,e){"use strict";e.r(r);var o=window.Jet,n="JrouteScript",u=new RegExp("new Jet\\([ |\r\n]*\\)","i"),i=new RegExp("JET\\([ |\r\n]*\\)","i"),a="F",_=o.__base__;o.__base__._useList.push("router");var s=_._JT,c=_.__ROOT,l=_._scoped_style_id;function f(t,r){t===o.router.index&&(o.router.indexMap=r),function(t,r){o.router.map[o.router.base+t]=r}(t,r.component);var e=r.children;for(var n in e)f(t+n,e[n])}var h={base:"",trueBase:!1,history:!1,path:"/",lastTrueHash:"",params:null,map:{},_initRouterOut:function(){return o.router.out&&o.router.out._JT_exist()||(o.router.out=s.attr("Jout")),o.router.out},use:function(t){o.router.index="index"in t?t.index:"/index",function(t){for(var r in"history"in t&&(o.router.history=t.history),"base"in t&&o.router.setBase(t.base,t.trueBase),t.history||(o.router.base+="/#"),t.router)""==t.router[r]&&(t.router[r]=r),f(r,t.router[r])}(t);var r=o.router.index;location.pathname._JT_has("index.html")||(o.router.history?location.pathname.length-o.router.base.length>1&&(r=location.pathname.substring(o.router.base.length)+location.search+location.hash):location.hash.length>2&&(r=(r=location.pathname+location.hash).substring(o.router.base.length)+location.search)),o.router._initRouterOut(),o.router.__await=function(){o.router.__await=null,t.oninit&&"function"==typeof t.oninit&&t.oninit(),o.router.__isFresh=!0,o.router.init(),o.router.route(r)},o.router.__hasInitJet&&(delete o.router.__hasInitJet,o.router.__await()),s.id(c)._JT_exist((function(t){t._JT_attr(_._jload,"root.html")._JT_attr(_._jpath,"false"),_._initSingleLoad("root",t,0,[t],(function(){t._JT_removeAttr(_.__comp_id)}))}))},conf:{html:"/src/html",js:"/src/js",css:"/src/css",image:"/src/image",media:"/src/media",base:"/src"},init:function(t){(null==t?s.attr("Jrouter"):t._JT_findAttr("Jrouter"))._JT_each((function(t){t._JT_clk((function(){o.router.route(this._JT_attr("Jrouter"))}))}))},setBase:function(t,r){if(o.router.base=t,!0===r)for(var e in o.router.trueBase=!0,o.router.conf)o.router.conf[e]=t+o.router.conf[e]},__xhr:null,__onroute:[],onroute:function(t,r){"function"==typeof t?(t._jet=r,t._name=r._tools.name,o.router.__onroute.push(t)):_._throw("onroute:参数必须是函数")},__onrouted:[],onrouted:function(t,r){"function"==typeof t?(t._jet=r,t._name=r._tools.name,o.router.__onrouted.push(t)):_._throw("onroute:参数必须是函数")},back:function(){window.history.back()},forward:function(){window.history.forward()},activeRouter:function(t){(t=t||s.attr('Jrouter="'+o.router.url+'"'))._JT_exist()&&(s.attr("jrouter-active")._JT_removeAttr("jrouter-active"),t._JT_attr("jrouter-active",""),o.router.active=t)},route:function(t,r,e){if(t._JT_has("http://")||t._JT_has("https://"))!0===r?o.$.open(t):o.$.jump(t);else{var c=o.router.__isFresh;c&&(o.router.__isFresh=!1),d("__onroute",c),null!==o.router.__xhr&&(o.router.__xhr.abort(),_._info("忽略了一个路由："+o.router.path+"；可能是由于点击过快"),o.router.__xhr=null);var l=function(t){var r="";if(-1!=t.indexOf("#")){var e=t.indexOf("?"),n=t.indexOf("#");-1!=e?e>n?(o.router.hash=t.substring(n,e),r=t.substring(e+1),t=t.substring(0,n),e=n):(o.router.hash=t.substring(n),r=t.substring(e+1,n),t=t.substring(0,e)):(o.router.hash=t.substring(n),e=n,t=t.substring(0,n))}else t._JT_has("?")&&(r=t.substring(t.indexOf("?")+1),t=t.substring(0,t.indexOf("?"))),o.router.hash="";"/"==t[t.length-1]&&t.length>1&&(t=t.substring(0,t.length-1));return{url:t,search:r}}(t),f=l.search;t=l.url;var h=s.attr('Jrouter="'+t+'"');o.router.activeRouter(h);var p=!1;(t=function(t){"/"==t[t.length-1]&&"/"!=t&&(t=t.substring(0,t.length-1));t=t==o.router.base?o.router.base+o.router.index:"/"!=t[0]?o.router.path+"/"+t:o.router.base+t;return t}(t))in o.router.map||(t=o.router.base+"/404",p=!0);var m=o.router.map[t];if(null!=m){""!=f&&(f="?"+f),o.router.path=t,o.router.url=t.substring(o.router.base.length);var b={},J=t,v=t+f+o.router.hash;"function"==typeof r&&(e=r,r=void 0),null==r&&history.pushState(b,J,v),p&&history.replaceState(b,J,v),o.router.params=s.urlParam(),o.router.lastTrueHash=location.hash,"undefined"!=typeof JUI&&window.JUI.dialog.removeAll();var T=_._buildCompHtml(m);o.router.__xhr=null;var g=o.router._initRouterOut()._JT_html(T);"undefined"!=typeof JUI&&(window.JUI._jui_mounted=[]),function(t){_._loadStyleCall(t,o.router.path,!0)}(g),function(t){s.id(n)._JT_exist()&&s.id(n)._JT_remove();var r,e=s.ct("script")._JT_attr({id:n,type:"text/javascript"}),o=["//# sourceURL=__router_comp_"+(a="T"==a?"F":"T")+".js\r\n"],c=t._JT_findTag("script")._JT_toArray(!1);c.length>0&&(r=_.__router_comp,t._JT_attr(_.__comp_id,r));for(var l=-1,f=c.length-1;f>=0;f--)if(c[f]._JT_hasAttr("src")){l=f;break}var h=function(t){var e='"'+_.__jet_root+'","'+r+'",';return null!==t.match(u)?t.replace(u,"new Jet("+e+"{})"):null!==t.match(i)?t.replace(i,"JET("+e+"{})"):t.replace("new Jet(","new Jet("+e).replace("JET(","JET("+e)};c._JT_each((function(t,r){if(t._JT_hasAttr("src"))s.load(_._getSrc(t._JT_attr("src"),"js"),(function(t){t=_._babel(t),o[r+1]=h(t),r==l&&(e._JT_html(o.join("")),s.body()._JT_append(e))}));else{var n=_._babel(t._JT_html());o[r+1]=h(n)}t._JT_remove()})),-1==l&&(e._JT_html(o.join(";")),s.body()._JT_append(e))}(g),_._loadCompRes(g),_._initValidAndLang(g),o.router.init(g),"undefined"!=typeof JUI&&window.JUI.init(g),o.load.init(g),e&&e(),d("__onrouted",c)}}}};function d(t,r){r||function(t){var r;if("__onroute"==t){if(!(r=o._unnamedJets[_.__router_comp]))return;o.router.__last_router_comp=r,p(r._tools._beforeunmount),function t(r){if(!r)return;for(var e in r)p(r[e]._tools._beforeunmount),t(r[e].$child)}(r.$child)}else if("__onrouted"==t){if(!(r=o.router.__last_router_comp))return;m(r),function t(r){if(!r)return;for(var e in r)m(r[e]),t(r[e].$child)}(r.$child)}}(t),o.router[t].forEach((function(t){t._jet?t.call(t._jet,r,o.router):t.call(o.router,r)}))}function p(t){t&&t()}function m(t){var r=t._tools.name;p(t._tools._onunmounted);var e=t._tools._ele[l];e&&"RouterOut"!==e&&s.attr(l+"="+e)._JT_remove(),b("__onroute",r),b("__onrouted",r),o.comp[r]&&o.comp[r].$DOM?delete o.comp[r]:o._unnamedJets[r]&&delete o._unnamedJets[r]}function b(t,r){var e=o.router[t].filter((function(t){return t._name===r}));e.length>0&&e.forEach((function(r){o.router[t]._JT_remove(r)}))}o.prototype.$route=function(t,r){o.router.route(t,r)},o.prototype.$route.back=function(){o.router.back()},o.prototype.$route.forward=function(){o.router.forward()},window.onhashchange=function(){o.router.lastTrueHash!=location.hash&&window.onpopstate()},window.onpopstate=function(){o.router.history?o.router.route(location.pathname.substring(o.router.base.length)+location.search+location.hash,!1):o.router.route(location.hash.substring(1),!1)},window.Jet.router=h,r.default=h}]).default}));